<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>午餐選擇器</title>
    <style>
        :root {
            --primary-color: #ff7e5f;
            --secondary-color: #feb47b;
            --background-color: #f9f9f9;
            --text-color: #333;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .tabs {
            display: flex;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        }
        
        .tab {
            padding: 15px 20px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            flex: 1;
            text-align: center;
            transition: var(--transition);
        }
        
        .tab:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .tab.active {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .main-button {
            display: block;
            width: 200px;
            height: 200px;
            margin: 20px auto;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
            line-height: 200px;
        }
        
        .main-button:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
        }
        
        .main-button:active {
            transform: scale(0.95);
        }
        
        .filter-group {
            margin-bottom: 20px;
        }
        
        h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .checkbox-group, .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .checkbox-label, .radio-label {
            display: flex;
            align-items: center;
            gap: 5px;
            background-color: #f0f0f0;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .checkbox-label:hover, .radio-label:hover {
            background-color: #e0e0e0;
        }
        
        input[type="checkbox"], input[type="radio"] {
            cursor: pointer;
        }
        
        .range-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        input[type="range"] {
            flex: 1;
        }
        
        .result-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .result-name {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .result-details {
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .result-detail {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-button {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .action-button:hover {
            background-color: var(--secondary-color);
        }
        
        .result-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 20px;
        }
        
        .favorites-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .favorite-item {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .favorite-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .favorite-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 10px;
        }
        
        .favorite-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .history-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .history-item:hover {
            background-color: #f0f0f0;
        }
        
        .history-image {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .history-details {
            flex: 1;
        }
        
        .history-date {
            color: #888;
            font-size: 0.9rem;
        }
        
        .chart-container {
            height: 300px;
            margin-top: 30px;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex-basis: 50%;
            }
            
            .main-button {
                width: 150px;
                height: 150px;
                line-height: 150px;
                font-size: 1.2rem;
            }
            
            .result-details {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>午餐選擇器</h1>
        <p>再也不用煩惱午餐吃什麼了！</p>
    </header>
    
    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="home">首頁</div>
            <div class="tab" data-tab="preferences">偏好設定</div>
            <div class="tab" data-tab="favorites">我的最愛</div>
            <div class="tab" data-tab="history">歷史紀錄</div>
            <div class="tab" data-tab="profile">統計資料</div>
        </div>
        
        <div class="tab-content active" id="home">
            <div class="main-button" id="randomButton">幫我選午餐</div>
            
            <div class="quick-filters">
                <div class="filter-group">
                    <h3>快速篩選</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="quickFilter" value="nearby"> 附近
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="quickFilter" value="cheap"> 便宜
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="quickFilter" value="fast"> 快速
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="quickFilter" value="healthy"> 健康
                        </label>
                    </div>
                </div>
            </div>
            
            <div id="result" style="display: none;">
                <div class="result-card">
                    <img src="/api/placeholder/150/150" alt="餐點圖片" class="result-image">
                    <h2 class="result-name" id="resultName">餐廳名稱</h2>
                    <div class="result-details">
                        <div class="result-detail">
                            <span>類型:</span>
                            <span id="resultType">中式</span>
                        </div>
                        <div class="result-detail">
                            <span>價格:</span>
                            <span id="resultPrice">$$</span>
                        </div>
                        <div class="result-detail">
                            <span>距離:</span>
                            <span id="resultDistance">500m</span>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="action-button" id="rerollButton">換一個</button>
                        <button class="action-button" id="saveButton">加入最愛</button>
                        <button class="action-button" id="shareButton">分享</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="preferences">
            <div class="filter-group">
                <h3>飲食偏好</h3>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="diet" value="all" checked> 無限制
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="diet" value="vegetarian"> 素食
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="diet" value="vegan"> 純素
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="diet" value="pescatarian"> 魚素食
                    </label>
                </div>
            </div>
            
            <div class="filter-group">
                <h3>料理類型</h3>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="chinese" checked> 中式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="japanese" checked> 日式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="korean" checked> 韓式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="western" checked> 西式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="italian" checked> 義式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="thai" checked> 泰式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="vietnamese" checked> 越式
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="cuisine" value="indian" checked> 印度
                    </label>
                </div>
            </div>
            
            <div class="filter-group">
                <h3>過敏原排除</h3>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="allergen" value="peanuts"> 花生
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="allergen" value="seafood"> 海鮮
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="allergen" value="dairy"> 乳製品
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="allergen" value="gluten"> 麩質
                    </label>
                </div>
            </div>
            
            <div class="filter-group">
                <h3>價格範圍</h3>
                <div class="range-group">
                    <span>$ 50</span>
                    <input type="range" id="priceRange" min="50" max="500" step="10" value="200">
                    <span>$ <span id="priceValue">200</span></span>
                </div>
            </div>
            
            <div class="filter-group">
                <h3>最大距離</h3>
                <div class="range-group">
                    <span>100m</span>
                    <input type="range" id="distanceRange" min="100" max="5000" step="100" value="1000">
                    <span><span id="distanceValue">1000</span>m</span>
                </div>
            </div>
            
            <button class="action-button" style="margin-top: 20px;" id="savePreferences">儲存偏好設定</button>
        </div>
        
        <div class="tab-content" id="favorites">
            <h3>我的最愛餐廳</h3>
            <div class="favorites-list" id="favoritesList">
                <!-- 動態生成內容 -->
            </div>
        </div>
        
        <div class="tab-content" id="history">
            <h3>最近的選擇</h3>
            <div id="historyList">
                <!-- 動態生成內容 -->
            </div>
        </div>
        
        <div class="tab-content" id="profile">
            <h3>統計資料</h3>
            <p>您的飲食偏好分析：</p>
            <div class="chart-container">
                <div id="cuisineChart" style="height: 100%; width: 100%;">圖表將在此顯示</div>
            </div>
            
            <h3 style="margin-top: 30px;">消費統計</h3>
            <div class="chart-container">
                <div id="priceChart" style="height: 100%; width: 100%;">圖表將在此顯示</div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        // 示範餐廳資料
        const restaurants = [
            { id: 1, name: "老王牛肉麵", type: "中式", price: "$$", distance: "300m", diet: "all", cuisine: "chinese", image: "/api/placeholder/150/150" },
            { id: 2, name: "鮮味壽司", type: "日式", price: "$$$", distance: "500m", diet: "pescatarian", cuisine: "japanese", image: "/api/placeholder/150/150" },
            { id: 3, name: "義大利麵工房", type: "義式", price: "$$", distance: "800m", diet: "vegetarian", cuisine: "italian", image: "/api/placeholder/150/150" },
            { id: 4, name: "素食天地", type: "中式", price: "$", distance: "200m", diet: "vegan", cuisine: "chinese", image: "/api/placeholder/150/150" },
            { id: 5, name: "韓式烤肉", type: "韓式", price: "$$$", distance: "1.2km", diet: "all", cuisine: "korean", image: "/api/placeholder/150/150" },
            { id: 6, name: "泰式料理", type: "泰式", price: "$$", distance: "600m", diet: "all", cuisine: "thai", image: "/api/placeholder/150/150" },
            { id: 7, name: "美式漢堡", type: "西式", price: "$$", distance: "400m", diet: "all", cuisine: "western", image: "/api/placeholder/150/150" },
            { id: 8, name: "越南河粉", type: "越式", price: "$", distance: "900m", diet: "all", cuisine: "vietnamese", image: "/api/placeholder/150/150" },
            { id: 9, name: "印度咖哩", type: "印度", price: "$$", distance: "1.5km", diet: "vegetarian", cuisine: "indian", image: "/api/placeholder/150/150" },
            { id: 10, name: "健康沙拉", type: "西式", price: "$$", distance: "700m", diet: "vegan", cuisine: "western", image: "/api/placeholder/150/150" }
        ];
        
        // 初始化我的最愛和歷史記錄
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let history = JSON.parse(localStorage.getItem('history')) || [];
        
        // 頁籤切換
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
                
                if (tab.dataset.tab === 'profile') {
                    renderCharts();
                }
                
                if (tab.dataset.tab === 'favorites') {
                    renderFavorites();
                }
                
                if (tab.dataset.tab === 'history') {
                    renderHistory();
                }
            });
        });
        
        // 隨機選擇餐廳
        document.getElementById('randomButton').addEventListener('click', () => {
            const dietFilter = document.querySelector('input[name="diet"]:checked').value;
            const cuisines = Array.from(document.querySelectorAll('input[name="cuisine"]:checked')).map(input => input.value);
            const allergens = Array.from(document.querySelectorAll('input[name="allergen"]:checked')).map(input => input.value);
            const maxPrice = document.getElementById('priceRange').value;
            const maxDistance = document.getElementById('distanceRange').value;
            
            // 篩選結果
            let filtered = restaurants.filter(restaurant => {
                if (dietFilter !== 'all' && restaurant.diet !== dietFilter && restaurant.diet !== 'all') return false;
                if (!cuisines.includes(restaurant.cuisine)) return false;
                // 更多篩選邏輯...
                return true;
            });
            
            if (filtered.length === 0) {
                filtered = restaurants; // 如果沒有符合條件的，顯示所有餐廳
            }
            
            // 隨機選擇一間餐廳
            const randomIndex = Math.floor(Math.random() * filtered.length);
            const selected = filtered[randomIndex];
            
            // 顯示結果
            document.getElementById('resultName').textContent = selected.name;
            document.getElementById('resultType').textContent = selected.type;
            document.getElementById('resultPrice').textContent = selected.price;
            document.getElementById('resultDistance').textContent = selected.distance;
            document.getElementById('result').style.display = 'block';
            
            // 加入歷史紀錄
            const historyItem = {
                ...selected,
                date: new Date().toLocaleString()
            };
            history.unshift(historyItem);
            if (history.length > 20) history.pop(); // 限制歷史記錄數量
            localStorage.setItem('history', JSON.stringify(history));
            
            // 滾動到結果
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        });
        
        // 重新選擇
        document.getElementById('rerollButton').addEventListener('click', () => {
            document.getElementById('randomButton').click();
        });
        
        // 加入最愛
        document.getElementById('saveButton').addEventListener('click', () => {
            const restaurantName = document.getElementById('resultName').textContent;
            const restaurant = restaurants.find(r => r.name === restaurantName);
            
            if (restaurant && !favorites.some(f => f.id === restaurant.id)) {
                favorites.push(restaurant);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                alert('已加入我的最愛！');
                renderFavorites();
            } else {
                alert('此餐廳已在我的最愛中！');
            }
        });
        
        // 分享功能
        document.getElementById('shareButton').addEventListener('click', () => {
            const restaurantName = document.getElementById('resultName').textContent;
            alert(`分享連結已複製：我今天的午餐是「${restaurantName}」，由「午餐選擇器」推薦！`);
        });
        
        // 價格範圍顯示
        document.getElementById('priceRange').addEventListener('input', (e) => {
            document.getElementById('priceValue').textContent = e.target.value;
        });
        
        // 距離範圍顯示
        document.getElementById('distanceRange').addEventListener('input', (e) => {
            document.getElementById('distanceValue').textContent = e.target.value;
        });
        
        // 儲存偏好設定
        document.getElementById('savePreferences').addEventListener('click', () => {
            alert('偏好設定已儲存！');
        });
        
        // 渲染我的最愛
        function renderFavorites() {
            const favoritesList = document.getElementById('favoritesList');
            favoritesList.innerHTML = '';
            
            if (favorites.length === 0) {
                favoritesList.innerHTML = '<p>還沒有加入最愛的餐廳</p>';
                return;
            }
            
            favorites.forEach(favorite => {
                const favoriteItem = document.createElement('div');
                favoriteItem.className = 'favorite-item';
                favoriteItem.innerHTML = `
                    <img src="${favorite.image}" alt="${favorite.name}" class="favorite-image">
                    <div class="favorite-name">${favorite.name}</div>
                    <div class="favorite-type">${favorite.type}</div>
                    <div class="favorite-price">${favorite.price}</div>
                `;
                favoriteItem.addEventListener('click', () => {
                    document.getElementById('resultName').textContent = favorite.name;
                    document.getElementById('resultType').textContent = favorite.type;
                    document.getElementById('resultPrice').textContent = favorite.price;
                    document.getElementById('resultDistance').textContent = favorite.distance;
                    document.getElementById('result').style.display = 'block';
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    
                    document.querySelector('.tab[data-tab="home"]').classList.add('active');
                    document.getElementById('home').classList.add('active');
                    
                    document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
                });
                favoritesList.appendChild(favoriteItem);
            });
        }
        
        // 渲染歷史紀錄
        function renderHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (history.length === 0) {
                historyList.innerHTML = '<p>還沒有歷史紀錄</p>';
                return;
            }
            
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="history-image">
                    <div class="history-details">
                        <div class="favorite-name">${item.name}</div>
                        <div class="favorite-type">${item.type} | ${item.price}</div>
                        <div class="history-date">${item.date}</div>
                    </div>
                `;
                historyItem.addEventListener('click', () => {
                    document.getElementById('resultName').textContent = item.name;
                    document.getElementById('resultType').textContent = item.type;
                    document.getElementById('resultPrice').textContent = item.price;
                    document.getElementById('resultDistance').textContent = item.distance;
                    document.getElementById('result').style.display = 'block';
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    
                    document.querySelector('.tab[data-tab="home"]').classList.add('active');
                    document.getElementById('home').classList.add('active');
                    
                    document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
                });
                historyList.appendChild(historyItem);
            });
        }
        
        // 渲染統計圖表
        function renderCharts() {
            // 料理類型分布圖
            const cuisineData = {
                labels: ['中式', '日式', '韓式', '西式', '義式', '泰式', '越式', '印度'],
                datasets: [{
                    label: '選擇次數',
                    data: [8, 6, 4, 5, 3, 2, 1, 1],
                    backgroundColor: [
                        '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', 
                        '#9966FF', '#FF9F40', '#C9CBCF', '#7CFC00'
                    ]
                }]
            };
            
            // 消費價格分布圖
            const priceData = {
                labels: ['一月', '二月', '三月', '四月', '五月', '六月'],
                datasets: [{
                    label: '平均消費（元）',
                    data: [120, 150, 130, 110, 170, 160],
                    backgroundColor: 'rgba(255, 126, 95, 0.2)',
                    borderColor: '#FF7E5F',
                    borderWidth: 2,
                    tension: 0.4,
                    fill: true
                }]
            };
            
            // 建立料理類型圖表
            const cuisineCtx = document.getElementById('cuisineChart');
            if (window.cuisineChart) window.cuisineChart.destroy();
            
            window.cuisineChart = new Chart(cuisineCtx, {
                type: 'doughnut',
                data: cuisineData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
            
            // 建立消費價格圖表
            const priceCtx = document.getElementById('priceChart');
            if (window.priceChart) window.priceChart.destroy();
            
            window.priceChart = new Chart(priceCtx, {
                type: 'line',
                data: priceData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // 初始化
        renderFavorites();
        renderHistory();
    </script>
</body>
</html>